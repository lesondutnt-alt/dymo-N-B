async function save() {
    // ---- Récupération des valeurs ----
    const selectedUser = user.value;
    const selectedLoc = location.value;

    const u = selectedUser === "Autre" ? userOther.value.trim() : selectedUser;
    const l = selectedLoc === "Autre" ? locOther.value.trim() : selectedLoc;

    // ---- Vérification des champs ----
    if (!selectedUser) 
        return alert("Veuillez sélectionner un utilisateur.");

    if (!u) 
        return alert("Veuillez entrer un nom.");

    if (!selectedLoc) 
        return alert("Veuillez sélectionner une localisation.");

    if (!l) 
        return alert("Veuillez entrer un lieu.");

    // ---- Construction du fichier JSON ----
    const payload = {
        user: u,
        location: l,
        ts: Date.now()
    };

    const content = {
        message: "Update dymo location",
        content: btoa(JSON.stringify(payload))
    };

    // ---- Récupération du SHA avant mise à jour ----
    try {
        const meta = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${FILE}`);
        const json = await meta.json();
        if (json.sha) content.sha = json.sha;
    } catch (e) {
        console.warn("Impossible de récupérer le SHA :", e);
    }

    // ---- Envoi vers GitHub ----
    try {
        await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${FILE}`, {
            method: "PUT",
            headers: {
                "Authorization": `Bearer ${TOKEN}`,
                "Content-Type": "application/json"
            },
            body: JSON.stringify(content)
        });

        alert("Localisation mise à jour !");
        load();

    } catch (e) {
        console.error(e);
        alert("Erreur lors de l'enregistrement !");
    }
}
