<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Suivi d'utilisation Dymo</title>
<style>
    body { font-family: Arial; padding: 20px; }
    label { font-weight: bold; }
    .last { background:#f0f0f0; padding:10px; border-radius:5px; margin-top:20px; }
    button { padding:10px 20px; margin-top:10px; cursor:pointer; }
</style>
</head>
<body>

<h2>ğŸ“Œ Suivi d'utilisation de la Dymo</h2>

<label>Utilisateur :</label><br>
<select id="user">
    <option>SÃ©bastien</option><option>Cyril</option><option>Claire</option>
    <option>Anna</option><option>LÃ©o</option><option>Laurent</option>
    <option>Simon</option><option>ClÃ©ment</option><option>Philippe</option>
    <option>Sadock</option><option>Thomas</option><option>Jonathan</option>
    <option>LoÃ¯c</option><option>Manu</option><option>Autre</option>
</select><br><br>

<label>Lieu :</label><br>
<select id="place">
    <option>Bureau de rÃ©gisseurs</option><option>Atelier lumiÃ¨re</option>
    <option>Studio son</option><option>Atelier GS</option>
    <option>Atelier cub</option><option>RÃ©gie GS</option>
    <option>RÃ©gie cub</option><option>Autre</option>
</select><br><br>

<button onclick="save()">Enregistrer</button>

<h3>ğŸ•’ DerniÃ¨re utilisation :</h3>
<div class="last" id="lastEntry">Chargementâ€¦</div>

<script>
const SHEET_URL = "https://script.google.com/macros/s/AKfycbwqonY6Qg-9z3kQBtvLwp7SRGTYuk8wHTkAEQoEYklpte8q6AKn6FcPhsJJyF8dWEQlmA/exec";

function save() {
    const user = document.getElementById("user").value;
    const place = document.getElementById("place").value;

    fetch(SHEET_URL + "?user=" + encodeURIComponent(user) + "&place=" + encodeURIComponent(place))
        .then(res => res.text())
        .then(() => {
            alert("EnregistrÃ© !");
            loadLast();
        });
}

function loadLast() {
    fetch(SHEET_URL + "?last=1")
        .then(res => res.json())
        .then(data => {
            document.getElementById("lastEntry").innerHTML =
                `ğŸ‘¤ Utilisateur : <b>${data.user}</b><br>
                 ğŸ“ Lieu : <b>${data.place}</b><br>
                 ğŸ•’ Date : <b>${data.date}</b>`;
        });
}

loadLast();
</script>

</body>
</html>
